<form method="POST">
  <Label>Category</Label>
  <select name="category">
    <option value="Travel" selected>Travel</option>
    <option value="Relationship">Relationship</option>
    <option value="Career">Career</option>
    <option value="Financial">Financial</option>
    <option value="Entertainment">Entertainment</option>
    <option value="Adventure">Adventure</option>
    <option value="Contribution">Contribution</option>
    <option value="Creativity">Creativity</option>
    <option value="Education">Education</option>
    <option value="Health">Health</option>
    <option value="Other">Other</option>
  </select>
  <button>Search</button>
</form>

{{#each data}}
<h3>{{this.title}}</h3>
<a href="/profile/{{this.creator._id}}">{{this.creator.name}}</h5></a><h5>
<img src="{{this.wishPicture}}" alt="{{this.title}} picture">
{{/each }}

<h3>Wishes map by category</h3>
<div id="map-single"></div>

<script>
  function init() {
    const mapContainerElement = document.getElementById('map-single');
    const map = new window.google.maps.Map(mapContainerElement, {
      center: {
        lat: 0,
        lng: 0
      },
      zoom: 1
    });
    const whishes = {{{ json data }}};
  for (let wish of whishes) {
    const contentString = `
      <a href="/wish/${ wish._id }"><p>${ wish.title }</p></a>
      `
      const infoWindow = new window.google.maps.InfoWindow({
        content: contentString,
        maxWidth: 200
      });
    const marker = new window.google.maps.Marker({
      map,
      position: {
        lat: wish.location.coordinates[1],
        lng: wish.location.coordinates[0]
      }
    });
    marker.addListener('click', () => {
      infoWindow.open(map, marker);
      const endpoint = `/${place._id}`;
      window.location = endpoint;
    });
  }
  }
</script>

<script defer
  src="https://maps.googleapis.com/maps/api/js?key={{ environmentVariables.GOOGLE_MAPS_API_KEY }}&callback=init"></script>